<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>My Profile</title>
    <script>
        $(document).ready(function () {
            $("#image").change(function () {
                readURL(this);
            });

        });
        $(document).ready(function () {
            $('#events .event-closer').click(function () {
                var eNumber = this.id;
                eNumber = parseInt(eNumber.substring(11))
                $.post(".",
                    {
                        submit: "Change",
                        type: "Event",
                        item: "delete",
                        itemId: eNumber
                    },
                    function (data, status) {
                        if (data == 200) {
                            $('#event' + eNumber).remove();
                        } else {
                            alert("We're unable to make your changes right now - try again in a few minutes.");
                        }
                    });
            });
        });
        $(document).ready(function () {
            $('#groups .group-closer').click(function () {
                var gNumber = this.id;
                gNumber = parseInt(gNumber.substring(11))
                $.post(".",
                    {
                        submit: "Change",
                        type: "Group",
                        item: "removeMe",
                        itemId: gNumber
                    },
                    function (data, status) {
                        if (data == 200) {
                            $('#group' + gNumber).remove();
                        } else {
                            alert("We're unable to make your changes right now - try again in a few minutes.");
                        }
                    });
            });
        });
        $(document).ready(function () {
            $(window).keydown(function (event) {
                if (event.keyCode == 13) {
                    // Validate:
                    if (!$('#resetPassword').hasClass('in') || ($('#secondResetPass').val() && $('#secondResetPass').val() === $('#firstResetPass').val())) {
                        return true;
                    } else {
                        event.preventDefault();
                        return false;
                    }
                }
            });
            $('#userName').click(function () {
                $('#userName').toggleClass("hidden");
                $('#userNameChangeSection').toggleClass("hidden");
            });
            $('#email').click(function () {
                $('#email').toggleClass("hidden");
                $('#userEmailChangeSection').toggleClass("hidden");
            });
            $('#birthday').click(function () {
                $('#birthday').toggleClass("hidden");
                $('#userBirthdayChangeSection').toggleClass("hidden");
            });
            $('#bio').click(function () {
                $('#bio').toggleClass("hidden");
                $('#userBioChangeSection').toggleClass("hidden");
            });

            $('#userNameChangeCancel').click(function () {
                $('#userName').toggleClass("hidden");
                $('#userNameChangeSection').toggleClass("hidden");
            });
            $('#userEmailChangeCancel').click(function () {
                $('#email').toggleClass("hidden");
                $('#userEmailChangeSection').toggleClass("hidden");
            });
            $('#userBirthdayChangeCancel').click(function () {
                $('#birthday').toggleClass("hidden");
                $('#userBirthdayChangeSection').toggleClass("hidden");
            });
            $('#userBioChangeCancel').click(function () {
                $('#bio').toggleClass("hidden");
                $('#userBioChangeSection').toggleClass("hidden");
            });

            $('#userNameChangeSubmit').click(function () {
                $.post(".",
                    {
                        submit: "Change",
                        type: "User",
                        item: "name",
                        firstName: $('#firstNameChange').val(),
                        lastName: $('#lastNameChange').val()
                    },
                    function (data, status) {
                        if (data == 200) {
                            // Change name; we succeeded:
                            $('#userName').text($('#firstNameChange').val() + " " + $('#lastNameChange').val());
                        } else {
                            alert("We're unable to make your changes right now - try again in a few minutes.");
                        }
                        $('#userName').toggleClass("hidden");
                        $('#userNameChangeSection').toggleClass("hidden");
                    });
            });
            $('#userEmailChangeSubmit').click(function () {
                $.post(".",
                    {
                        submit: "Change",
                        type: "User",
                        item: "email",
                        email: $('#userEmailChange').val(),
                    },
                    function (data, status) {
                        if (data == 200) {
                            // Change name; we succeeded:
                            $('#email').text($('#userEmail').val());
                        } else {
                            alert("We're unable to make your changes right now - try again in a few minutes.");
                        }
                        $('#userEmailChangeSection').toggleClass("hidden");
                        $('#email').toggleClass("hidden");
                    });
            });
            $('#userBirthdayChangeSubmit').click(function () {
                $.post(".",
                    {
                        submit: "Change",
                        type: "User",
                        item: "birthday",
                        month: $('#userBirthdayMonthChange').val(),
                        day: $('#userBirthdayDayChange').val()
                    },
                    function (data, status) {
                        if (data == 200) {
                            // Change name; we succeeded:
                            $('#birthday').text("Birthday: " + $('#userBirthdayMonthChange').find(':selected').text() + " " + $('#userBirthdayDayChange').val());
                        } else {
                            alert("We're unable to make your changes right now - try again in a few minutes.");
                        }
                        $('#userBirthdayChangeSection').toggleClass("hidden");
                        $('#birthday').toggleClass("hidden");
                    });
            });
            $('#userBioChangeSubmit').click(function () {
                $.post(".",
                    {
                        submit: "Change",
                        type: "User",
                        item: "bio",
                        bio: $('#userBioChange').val()
                    },
                    function (data, status) {
                        if (data == 200) {
                            // Change name; we succeeded:
                            $('#bio').val($('#userBioChange').val())
                        } else {
                            alert("We're unable to make your changes right now - try again in a few minutes.");
                        }
                        $('#userBioChangeSection').toggleClass("hidden");
                        $('#bio').toggleClass("hidden");
                    });
            });

            $('#userBirthdayMonthChange').change(function () {
                $('.days').remove();
                for (var i = 1; i <= daysInMonth($('#userBirthdayMonthChange').val()); i++) {
                    // Create a day:
                    $("<option class=\"days\" value=\"" + i + "\">" + i + "</option>").appendTo($('#days'));
                }

            });

            $('#resetSubmit').hide();
            $('#firstResetPass').keyup(function () {
                if ($('#secondResetPass').val() === $('#firstResetPass').val() && $('#secondResetPass').val()) {
                    // We are good to go!
                    $('#secondResetPass').parent().removeClass('has-error');
                    $('#secondResetPass').parent().addClass('has-success');
                    $('#firstResetPass').parent().removeClass('has-error');
                    $('#firstResetPass').parent().addClass('has-success');
                    $('#resetSubmit').show();
                } else {
                    // Passwords don't match; disable submit and warn
                    $('#secondResetPass').parent().removeClass('has-success');
                    $('#secondResetPass').parent().addClass('has-error');
                    $('#firstResetPass').parent().removeClass('has-success');
                    $('#firstResetPass').parent().addClass('has-error');
                    $('#resetSubmit').hide();
                }
            });
            $('#secondResetPass').keyup(function () {
                if ($('#secondResetPass').val() === $('#firstResetPass').val() && $('#secondResetPass').val()) {
                    // We are good to go!
                    $('#secondResetPass').parent().removeClass('has-error');
                    $('#secondResetPass').parent().addClass('has-success');
                    $('#firstResetPass').parent().removeClass('has-error');
                    $('#firstResetPass').parent().addClass('has-success');
                    $('#resetSubmit').show();
                } else {
                    // Passwords don't match; disable submit and warn
                    $('#secondResetPass').parent().removeClass('has-success');
                    $('#secondResetPass').parent().addClass('has-error');
                    $('#firstResetPass').parent().removeClass('has-success');
                    $('#firstResetPass').parent().addClass('has-error');
                    $('#resetSubmit').hide();
                }
            });
        });
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $('#previewImage').attr('src', e.target.result);
                    $('#previewImage').removeClass("hidden");
                    $('#submitImg').removeClass("hidden");
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        function daysInMonth(month) {
            // No leap day
            if (month == 0) {
                return 0;
            }
            return new Date(1999, month, 0).getDate();
        }
    </script>
    <style>
        .input-group,
        .form-group,
        .spaced,
        .input {
            margin: 10px;
        }
        body {
            background-color: #CECECE;
            color: black;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        h2 {
            font-style: italic;
        }
        #userImage {
            height: 256px;
            width: 256px;
            display: inline;
            cursor: pointer;
        }
        #previewImage {
            height: 256px;
            width: 256px;
            display: inline;
        }
        .circle {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: inline-flex;
        }
        p {
            font-weight: 400;
            text-indent: each-line 20px;
            font-size: 22px;
        }
        .glyphicon {
            font-size: 75%;
        }
        table {
            width: 75%;
        }
        .btn {
            width: 100%;
        }
        .event-closer,
        .group-closer,
        .event-name,
        .group-name,
        #eventAdder,
        #groupAdder {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div id="uploadImage" class="modal fade panel-success" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-success">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Upload new image</h4>
                    </div>
                    <div class="modal-body">
                        <form id="imgUploadForm" method="post" name="imgUploadForm" enctype="multipart/form-data">
                            <div class="row text-center">
                                <div class="form-group">
                                    <label class="btn btn-default btn-file">
                                        Browse <input id="image" name="image" accept="image/*" type="file" style="display: none;">
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group text-center">
                                    <img id="previewImage" src="" class="img-circle img-responsive hidden" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group text-center">
                                    <button id="submitImg" form="imgUploadForm" type="submit" class="btn btn-primary hidden" name="submit" value="Profile">
                                        Upload Picture
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="resetPassword" class="modal fade panel-danger" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-danger">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Reset your Password</h4>
                    </div>
                    <div class="modal-body">
                        <form id="resetForm" method="post">
                            <div class="input-group">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                                <input name="password" type="password" class="form-control" id="firstResetPass" placeholder="New Password" />
                            </div>
                            <div class="input-group has-feedback">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                                <input type="password" class="form-control" id="secondResetPass" placeholder="Confirm New Password" />
                            </div>
                            <input class="hidden form-control" name="userID" type="hidden" value="" />
                            <button id="resetSubmit" type="submit" name="submit" form="resetForm" value="PasswordReset" class="btn btn-success">
                                Change Password
                            </button>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="changePreferences" class="modal fade panel-primary" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-primary">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Change Preferences</h4>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="addEvent" class="modal fade panel-info" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-info">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Add New Event</h4>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="addGroup" class="modal fade panel-info" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-info">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Add New Group</h4>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="editEvent" class="modal fade panel-success" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-success">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 id="editEventTitle" class="modal-title">Edit Event</h4>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="editGroup" class="modal fade panel-success" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content panel-success">
                    <div class="modal-header panel-heading">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 id="editGroupTitle" class="modal-title">Edit Group</h4>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4 text-center">
                <!-- User Image -->
                <img id="userImage" type="button" data-tooltip="tooltip" data-placement="bottom auto" title="Click to select new image" data-toggle="modal" href="#uploadImage" class="img-circle img-responsive" src="resources/images/users/default.png" />
                <div class="form-group">
                    <h1 role="button" id="userName" class="form-control-static"></h1>
                </div>
                <div id="userNameChangeSection" class="form-group hidden">
                    <div class="col-md-4">
                        <input style="margin:5px;" type="text" class="form-control" id="firstNameChange" placeholder="First Name" />
                    </div>
                    <div class="col-md-4">
                        <input style="margin:5px;" type="text" class="form-control" id="lastNameChange" placeholder="Last Name" />
                    </div>
                    <div class="col-md-2">
                        <button id="userNameChangeSubmit" class="btn btn-success" type="button">
                            Confirm
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button id="userNameChangeCancel" class="btn btn-danger" type="button">
                            Cancel
                        </button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <button class="btn btn-lg btn-danger" type="button" id="resetPassword" data-toggle="modal" data-target="#resetPassword">
                            <div class="hidden-sm hidden-xs">Change Password </div><span class="glyphicon glyphicon-lock"></span>
                        </button>
                    </div>
                    <div class="col-xs-6">
                        <button class="btn btn-lg btn-primary" type="button" id="changePreferences" data-toggle="modal" data-target="#changePreferences">
                            <div class="hidden-sm hidden-xs">Change Preferences </div><span class="glyphicon glyphicon-cog"></span>
                        </button>
                    </div>
                </div>
                <h3 id="timeMember"></h3>
            </div>
            <div class="col-sm-5">
                <!-- User Information -->
                <div class="form-group">
                    <h2 role="button" id="email" class="form-control-static"></h2>
                </div>
                <div id="userEmailChangeSection" class="form-group hidden">
                    <div class="row">
                        <div class="col-md-8">
                            <input style="margin:5px;" type="email" class="form-control" id="userEmailChange" placeholder="Email Address" />
                        </div>
                        <div class="col-md-2">
                            <button id="userEmailChangeSubmit" class="btn btn-success" type="button">
                                Confirm
                            </button>
                        </div>
                        <div class="col-md-2">
                            <button id="userEmailChangeCancel" class="btn btn-danger" type="button">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <h2 role="button" id="birthday" class="form-control-static"></h2>
                </div>
                <div id="userBirthdayChangeSection" class="form-group hidden">
                    <div class="row">
                        <div class="col-md-4">
                            <select class="form-control" id="userBirthdayMonthChange">
                                <optgroup label="Month">
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <select id="userBirthdayDayChange" class="form-control">
                                <optgroup id="days" label="Day">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button id="userBirthdayChangeSubmit" class="btn btn-success" type="button">
                                Confirm
                            </button>
                        </div>
                        <div class="col-md-2">
                            <button id="userBirthdayChangeCancel" class="btn btn-danger" type="button">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
                <h2>Theme: <span id="theme" class="circle" style=""></span></h2>
                <!-- Theme button -->
                <h2>Bio: </h2>
                <div class="form-group">
                    <p role="button" id="bio" class="form-control-static"></p>
                </div>
                <div id="userBioChangeSection" class="form-group hidden">
                    <div class="row">
                        <div class="col-md-8">
                            <textarea class="form-control" rows="5" id="userBioChange"></textarea>
                        </div>
                        <div class="col-md-2">
                            <button id="userBioChangeSubmit" class="btn btn-success" type="button">
                                Confirm
                            </button>
                        </div>
                        <div class="col-md-2">
                            <button id="userBioChangeCancel" class="btn btn-danger" type="button">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
                <p id="bio"></p>
            </div>
            <div class="col-sm-3 hidden-xs">
                <!-- Add Side Navigation Bar (From Dashboard) -->
                <div id="navigator" class="panel">
                    <div class="text-center panel-heading">Quick Links</div>
                    <div class="panel-body">
                        <ul class="nav nav-pills nav-stacked">
                            <li><a href=".?dest=dashboard">Dashboard</a></li>
                            <li><a href=".?dest=myList">My List</a></li>
                            <li><a href=".?dest=myGroups">My Groups</a></li>
                            <li class="active"><a href=".?dest=profile">My Account</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4">
                <h1 class="text-left">Events</h1>
                <table id="events">
                </table>
            </div>
            <div class="col-sm-4">
                <h1 class="text-left">Groups</h1>
                <table id="groups">
                    
                </table>
            </div>
        </div>
    </div>
</body>
</html>